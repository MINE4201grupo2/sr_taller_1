var System={functions:{},register:function(t,e,i){System.functions[t]={requires:e,cb:i}},active:function(){$.each(System.functions,function(t,e){var i=e.cb(function(t,i){e[t]=i},{id:t});$.each(i.setters,function(t,i){i(System.functions[e.requires[t]])}),i.execute()})}};System.register("libs/vars",[],function(t,e){"use strict";var i;e&&e.id;return{setters:[],execute:function(){i=function(){function t(){}return t.statusToDate=function(e,i){var a=e.filter(function(t){return t.status===i});return a.length?t.format(a[0].date):""},t.format=function(t){if(!t)return"";var e=["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],i=new Date;return i.setTime(Date.parse(t)),i.getDate()+" de "+e[i.getMonth()]+" de "+i.getFullYear()},t.formatSimple=function(t){var e=new Date(Date.parse(t));return e.getFullYear()+"-"+this.zeroPadded(e.getMonth()+1)+"-"+this.zeroPadded(e.getDate())+" "+this.zeroPadded(e.getHours())+":"+this.zeroPadded(e.getMinutes())},t.zeroPadded=function(t){return t>=10?t:"0"+t},t.formatMoney=function(t,e,i,a,r){void 0===e&&(e=0),void 0===i&&(i="$"),void 0===a&&(a=","),void 0===r&&(r=".");var s="\\d(?=(\\d{3})+"+(e>0?"\\D":"$")+")";return i+t.toFixed(Math.max(0,~~e)).replace(".",r).replace(new RegExp(s,"g"),"$&"+a)},t.getParameterByName=function(t,e){void 0===e&&(e=window.location.href),t=t.replace(/[[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),a=i.exec(e);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null},t.capitalize=function(t){return t[0].toUpperCase()+t.slice(1)},t.b=$("body"),t.urlApi=t.b.attr("api_url"),t.imgNoAvailable="/images/imagen_no_disponible.svg",t.store=t.b.data("store"),t.place=t.b.data("defaultPlace"),t}(),t("Vars",i)}}}),System.register("libs/get_api",["../util/sclib.d","libs/vars"],function(t,e){"use strict";var i,a;e&&e.id;return{setters:[function(t){},function(t){i=t}],execute:function(){a=function(){function t(t){this.h={},t&&(this.h={Authorization:"bearer "+t})}return t.prototype.g=function(t){return sclib.ajax({url:i.Vars.urlApi+t,type:"GET",headers:this.h})},t.prototype.p=function(t,e){return void 0===e&&(e={}),sclib.ajax({url:i.Vars.urlApi+t,type:"POST",headers:this.h,data:JSON.stringify(e)})},t.prototype.d=function(t){return sclib.ajax({url:i.Vars.urlApi+t,type:"DELETE",headers:this.h})},t}(),t("GetApi",a)}}}),System.register("libs/session",["libs/get_api","libs/vars"],function(t,e){"use strict";var i,a,r;e&&e.id;return{setters:[function(t){i=t},function(t){a=t}],execute:function(){r=function(){function t(){var t;this.token=localStorage.getItem("token");try{this.user=JSON.parse(localStorage.getItem("user")),this.token?((null===(t=this.user)||void 0===t?void 0:t.email)&&$(".userEmail").html(this.user.email),$(".nologin").hide(),$(".login").show()):($(".login").hide(),$(".nologin").show())}catch(t){$(".login").hide(),$(".nologin").show()}$("#signupForm").length&&this.token&&window.location.replace("/"),$("#editEvent,#newEvent,.project-view").length&&!this.token&&window.location.replace("/"),$("#loginForm").data("post",function(t,e){localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),e()}),$("#signupForm").data("post",function(t,e){e()}),this.getApi=new i.GetApi(this.token),this.find(),this.view(),this.edit(),this.listPublic(),this.viewPublic(),this.viewPublicDesignListAll()}return t.prototype.find=function(t){var e=this;void 0===t&&(t=1);var i=$(".project-list");i.length&&this.getApi.g("api/projects?page="+t).done(function(r){var s='<table class="small hide-xs striped"><thead><tr><th>&nbsp;</th><th>CREADO</th><th>NOMBRE</th><th>DESCIPCIÃ“N</th><th class="tr">VALOR ESTIMADO A PAGAR</th><th>&nbsp;</th></tr></thead>';$.each(r.results,function(t,e){s+='<tr><td class="tc"><a href="/detalle-proyecto?id='+(e.id||e._id)+'"><i class="fas fa-search big"></i></a></td><td>'+a.Vars.format(e.created_at||e.createdAt)+'</td><td class="b">'+e.name+"</td><td>"+e.description+'</td><td class="tr t-primary">'+a.Vars.formatMoney(e.amount)+'</td><td class="tc"><button class="flat" data-id="'+(e.id||e._id)+'"><i class="fas fa-trash"></i></button></td></tr>'}),s+="</table>",s+='<div class="mobile show-xs">',$.each(r.results,function(t,e){s+='<table class="small striped"><tr><th>Fecha</th><td class="tl nowrap">'+a.Vars.format(e.created_at||e.createdAt)+'</td></tr><tr><td colspan="2" class="b big">'+e.name+'</td></tr><tr><td colspan="2" class="bt-1 tl nowrap">'+e.description+'</td></tr><tr><th>Valor estimado a pagar</th><td class="tr nowrap t-primary">'+a.Vars.formatMoney(e.amount)+'</td></tr><tr><td><a class="button primary w-100" href="/detalle-proyecto?id='+(e.id||e._id)+'">Ver detalles</a></td><td><button class="secondary w-100" data-id="'+(e.id||e._id)+'">Eliminar</button></td></tr></table>'}),s+="</div>",s+='<nav class="mt-3"><ul class="pagination justify-content-center">';for(var n=1;n<=Math.ceil(r.count/r.limit);n++)s+='<li class="'+(n===r.page?"active":"")+'"><a class="item" data-page="'+n+'">'+n+"</a></li>";s+="</ul></nav>",i.html(s),i.find("nav .item").click(function(t){e.find($(t.currentTarget).data("page"))}),i.find("button").click(function(i){var a=$(i.currentTarget);sclib.modalShow("#delete"),$("#delete .delete").unbind("click").click(function(){e.getApi.d("api/projects/"+a.data("id")).done(function(){sclib.modalHide("#delete"),e.find(t)})})})})},t.prototype.view=function(){var t=this,e=$(".project-view");e.length&&(this.getApi.g("api/projects/"+a.Vars.getParameterByName("id")).done(function(i){var r='<table class="small striped"><tr><th>URL:</th><td class="tl nowrap">'+i.url+'</td></tr><tr><th>FECHA CREADO:</th><td class="tl nowrap">'+a.Vars.formatSimple(i.created_at||i.createdAt)+'</td></tr><tr><td colspan="2" class="tc b big">'+i.name+'</td></tr><tr><td colspan="2" class="">'+i.description+'</td></tr><tr><th>VALOR ESTIMADO A PAGAR:</th><td class="tl nowrap t-prrimary">'+a.Vars.formatMoney(i.amount)+'</td></tr><tr><td colspan="2"><div class="tr"><a class="button primary mr-1" href="/editar-proyecto?id='+(i.id||i._id)+'">Editar</a><button class="secondary ml-1" data-id="'+(i.id||i._id)+'">Eliminar</button></div></td></tr></table>';$(".name,.name-link").html(i.name),$(".name-link").attr("href","/detalle-proyecto?id="+(i.id||i._id)),e.html(r),e.find("button").click(function(e){var i=$(e.currentTarget);sclib.modalShow("#delete"),$("#delete .delete").unbind("click").click(function(){t.getApi.d("api/projects/"+i.data("id")).done(function(){sclib.modalHide("#delete"),window.location.replace("/")})})})}),this.viewDesignList(a.Vars.getParameterByName("id")))},t.prototype.viewDesignList=function(t,e){var i=this;void 0===e&&(e=1);var r=$(".project-view-design-list");this.getApi.g("api/projects/"+t+"/designs?page="+e).done(function(e){var s='<table class="small striped"><thead><tr><th></th><th>CREADO</th><th>NOMBRE</th><th>EMAIL</th><th class="tr">VALOR PEDIDO</th><th colspan="2">&nbsp;</th></tr></thead>';$.each(e.results,function(t,e){s+='<tr><td><img src="'+e.resize+'" style="height: 80px;"></td><td>'+a.Vars.format(e.created_at||e.createdAt)+'</td><td class="b">'+e.first_name+" "+e.last_name+"</td><td>"+e.email+'</td><td class="tr t-primary">'+a.Vars.formatMoney(e.price)+'</td><td class="tc"><a href="'+e.image+'" target="_blank">Original</a></td><td class="tc"><a href="'+e.resize+'" target="_blank">Procesado</a></td></tr>'}),s+="</table>",s+='<nav class="mt-3"><ul class="pagination justify-content-center">';for(var n=1;n<=Math.ceil(e.count/e.limit);n++)s+='<li class="'+(n===e.page?"active":"")+'"><a class="item" data-page="'+n+'">'+n+"</a></li>";s+="</ul></nav>",r.html(s),r.find("nav .item").click(function(e){i.viewDesignList(t,$(e.currentTarget).data("page"))})})},t.prototype.edit=function(){var t=$("#editEvent");t.length&&this.getApi.g("api/projects/"+a.Vars.getParameterByName("id")).done(function(e){t.attr("action",a.Vars.urlApi+"api/projects/"+(e.id||e._id)),$("#name").val(e.name),$("#description").val(e.description),$("#amount").val(e.amount),$(".name,.name-link").html(e.name),$(".name-link").attr("href","/detalle-proyecto?id="+(e.id||e._id))})},t.prototype.listPublic=function(t){var e=this;void 0===t&&(t=1);var i=$(".public-project-list");i.length&&this.getApi.g("api/public/projects/"+$("#company").data("slug")+"?page="+t).done(function(t){var r='<div class="row">';$.each(t.results,function(t,e){r+='<div class="col-md-4 pt-6"><a href="/'+e.url+'"><div class="br-1 white h-100 p-6"><div class="tc b">'+e.name+'</div><div class="hr"></div><div class="mh-3">'+e.description+'</div><div class="hr"></div><div class="tc b t-primary big">'+a.Vars.formatMoney(e.amount)+"</div></div></a></div>"}),r+="</div>",r+='<nav class="mt-3"><ul class="pagination justify-content-center">';for(var s=1;s<=Math.ceil(t.count/t.limit);s++)r+='<li class="'+(s===t.page?"active":"")+'"><a class="item" data-page="'+s+'">'+s+"</a></li>";r+="</ul></nav>",i.html(r),i.find("nav .item").click(function(t){e.listPublic($(t.currentTarget).data("page"))})})},t.prototype.viewPublic=function(){var t=this,e=$(".public-project-view-d");e.length&&this.getApi.g("api/public/projects/"+$("#company").data("slug")+"/"+$("#company").data("project")).done(function(i){var r='<div class="row">';r+='<div class="col-md-8 pt-3"><div class="tc b">'+i.name+'</div></div><div class="col-md-4 pt-3"><div class="tc b t-primary big">'+a.Vars.formatMoney(i.amount)+'</div></div><div class="col-md-12 pt-3"><div class="hr"></div><div class="mh-3">'+i.description+"</div></div>",r+="</div>",e.html(r),t.viewPublicDesignList(i.id||i._id)}),$(".public-project-view-b").click(function(){$("#successful").val(window.location.origin+"/successful"),$("#error").val(window.location.origin+"/error"),$("#projectForm").attr("action",$("#projectForm").attr("action")+"/api/public/projects/"+$("#company").data("slug")+"/"+$("#company").data("project")),sclib.modalShow("#new")})},t.prototype.viewPublicDesignList=function(t,e){var i=this;void 0===e&&(e=1);var a=$(".project-view-design-list");this.getApi.g("api/public/projects/"+t+"/designs?page="+e).done(function(e){var r='<div class="row">';$.each(e.results,function(t,e){r+='<div class="col-md-4"><div class="br-1 rd-1 m-3" style="background-image: url('+e.resize+');height: 300px;background-size: cover;background-position: center center;"></div></div>'}),r+="</div>",r+='<nav class="mt-3"><ul class="pagination justify-content-center">';for(var s=1;s<=Math.ceil(e.count/e.limit);s++)r+='<li class="'+(s===e.page?"active":"")+'"><a class="item" data-page="'+s+'">'+s+"</a></li>";r+="</ul></nav>",a.html(r),a.find("nav .item").click(function(e){i.viewPublicDesignList(t,$(e.currentTarget).data("page"))})})},t.prototype.viewPublicDesignListAll=function(){var t=$(".project-view-design-list-all");t.length&&this.getApi.g("api/public/designs-all").done(function(e){var i="";$.each(e,function(t,e){i+='<div class="col-md-4"><div class="br-1 rd-1 m-3" style="background-image: url('+e.resize+');height: 300px;background-size: cover;background-position: center center;"></div></div>'}),i+="",t.html(i)})},t}(),t("Session",r)}}}),System.register("home",["./libs/define","libs/session"],function(t,e){"use strict";var i;e&&e.id;return{setters:[function(t){},function(t){i=t}],execute:function(){new i.Session}}}),System.active();